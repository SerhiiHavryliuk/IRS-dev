var APP={browser:function(){"use strict";var e,t="",n=window.navigator.userAgent,i=window.navigator.platform,o={os:{win:!1,mac:!1,linux:!1,android:!1,ios:!1},browser:{opera:!1,ie:!1,firefox:!1,chrome:!1,safari:!1,android:!1},version:0};return/MSIE/.test(n)?(e=/MSIE \d+[.]\d+/.exec(n)[0].split(" ")[1],o.browser.ie=!0,o.version=parseInt(e,10)):/Android/.test(n)?(o.os.android=!0,o.browser.android=!0,/Chrome/.test(n)&&(e=/Chrome\/[\d\.]+/.exec(n)[0].split("/")[1],o.version=parseInt(e,10),o.browser.chrome=!0,o.browser.android=!1),/Firefox/.test(n)&&(e=/Firefox\/[\.\d]+/.exec(n)[0].split("/")[1],o.browser.firefox=!0,o.version=parseInt(e,10),o.browser.android=!1)):/Chrome/.test(n)?(e=/Chrome\/[\d\.]+/.exec(n)[0].split("/")[1],o.browser.chrome=!0,o.version=parseInt(e,10)):/Opera/.test(n)?o.browser.opera=!0:/Firefox/.test(n)?(e=/Firefox\/[\.\d]+/.exec(n)[0].split("/")[1],o.browser.firefox=!0,o.version=parseInt(e,10)):/Safari/.test(n)&&((/iPhone/.test(n)||/iPad/.test(n)||/iPod/.test(n))&&(o.os.ios=!0),o.browser.safari=!0),e||(e=/Version\/[\.\d]+/.exec(n),e?(e=e?e[0].split("/")[1]:/Opera\/[\.\d]+/.exec(n)[0].split("/")[1],o.version=parseInt(e,10)):document.all.length&&(o.version=11,o.browser.ie=!0)),"MacIntel"===i||"MacPPC"===i?o.os.mac=!0:"Win32"===i||"Win64"===i?o.os.win=!0:!t&&/Linux/.test(i)?o.os.linux=!0:!t&&/Windows/.test(n)?o.os.win=!0:!t&&/android/.test(n)&&(o.os.android=!0),o}(),viewport:function(){var e={};return e.refresh=function(){var t=new Array;void 0!==window.innerHeight?t=[window.innerWidth,window.innerHeight]:(wwSizeIE=document.documentElement?document.documentElement:document.body,t=[wwSizeIE.clientWidth,wwSizeIE.clientHeight]),e.width=t[0],e.height=t[1],e.width<749?e.device="mobile":e.width<981?e.device="tablet":e.device="desktop"},e.refresh(),e}(),init:function(){"use strict";window.addEventListener("DOMContentLoaded",function(){module.main.init()}),window.addEventListener("resize",function(){APP.viewport.refresh()})}};APP.init(),window.module||(window.module={}),module.main=function(){"use strict";function e(){document;o.Html=$("html")}function t(){var e=(document.body,$(document)),t=window;t.addEventListener("submit",r.formSubmit,!1),e.on("click",".show-popup",r.clickForPopup)}function n(){function e(){t.wookmark({offset:50,align:"left"})}$(".select-custom").customSelect(),$(".quantity").quantityInit({min:1,max:18,step:1});var t=$(".layout-list_waterfall");t.length&&(e(),$(window).resize(function(){e()}))}function i(){e(),t(),n()}var o={Timer:null},a={validateForm:function(e){var t=!0;return clearTimeout(o.Timer),$(e).find("[required]").each(function(){""==$(this).val()&&(t=!1,$(this).addClass("validate-invalid"))}),$(e).find("[type=email]").each(function(){$(this).hasClass("validate-invalid")||/^\w+[a-zA-Z0-9_.-]*@{1}\w{1}[a-zA-Z0-9_.-]*\.{1}\w{2,4}$/.test($(this).val())||(t=!1,$(this).addClass("validate-invalid"))}),o.Timer=setTimeout(function(){$(".validate-invalid").removeClass("validate-invalid")},3e3),t},ajaxAddContent:function(e){var t=$(this).data("url"),n=$(this).data("data"),i=$(this).data("container");$.ajax({url:t,type:"post",data:n,dataType:"json",success:function(e){$(i).append(e.content)},error:function(e){console.log(e)}})}},r={formSubmit:function(e){var t,n=e.target,i=(document.activeElement,function(e){n.reset(),e.showmodal&&r.showPopup(n,e.showmodal)}),o=function(e){console.log(e)};if(1==$(n).data("validate")){$(".validate-invalid").removeClass("validate-invalid");var s=a.validateForm(n);if(!s)return e.preventDefault(),!1}1==$(n).data("ajax")&&(e.preventDefault(),t={url:n.getAttribute("action"),type:n.getAttribute("method"),data:$(n).serialize(),dataType:"json",success:i,error:o},$.ajax(t))},showPopup:function(e,t){var n=e.getAttribute("data-type-popup");n=JSON.parse(n),module.popup.show({element:e,subClass:"message",message:t,type:n.type,backgroundVisibility:n.bgVis,popupPos:n.pos})},clickForPopup:function(e){var t=e.target,n=t.getAttribute("data-type-popup");n=JSON.parse(n),n=n.idTemplate,r.showPopup(t,$("#"+n))},moreGoods:function(){var e=$(o.filterForm).serialize();a.getMoreCards(e)},preventDefault:function(e){e.preventDefault()}};return{init:i}}(),window.module||(window.module={}),module.popup=function(){"use strict";function e(){var e=this,t=[];return this.controls={isVisible:!1,inDom:!1,handlers:null},this.handlers={showPopup:function(t,n){e.controls.isVisible=!0,t.classList.add("active"),setTimeout(function(){t.classList.add("animate"),n.classList.add("active")},100)},hidePopup:function(e,t,n){var i=function(){e.removeEventListener("transitionend",i),e.removeEventListener("webkitTransitionEnd",i),e.classList.remove("active"),t.classList.remove("active"),e.classList.remove("active"),e.parentNode.removeChild(e),e.classList.remove("popup_without-background"),t.classList.remove("popup-window_compact"),t.style.left="auto",t.style.top="auto"};n.isVisible||(n.hideCallback=null,n.showCallback=null),n.isVisible=!1,e.classList.remove("animate"),e.addEventListener("transitionend",i),e.addEventListener("webkitTransitionEnd",i),void 0===document.all||window.atob||i()},show:function(n){var i,o,a,r,s,l,c,d=e.controls,u=d.background,p=d.popup,h=d.popupContent,m=[],f=n.showCallback||function(){return!1},v=n.handlers;if(d.handlers=v,d.hideCallback=n.hideCallback||function(){return!1},void 0===n.type&&(n.type=""),document.body.appendChild(d.background),n.backgroundVisibility||u.setAttribute("class","popup popup_without-background"),"center"!=n.popupPos){var w=e.handlers.getPos(n.element);p.classList.add("popup-window_compact"),p.style.left=w.left+"px",p.style.top=w.top+"px"}if(e.addEventList(),n.bgClass&&u.classList.add(n.bgClass),h.setAttribute("class","popup-content"),n instanceof Object)switch(n.type){case"confirm":m=e.create.confirm(n);break;case"htmlTemplate":m=e.create.htmlTemplate(n);break;default:m=e.create.empty(n.message)}else m=e.create.empty(n);for(n.message instanceof DocumentFragment?(h.innerHTML="",h.appendChild(n.message)):h.innerHTML=m.join(""),r=h.querySelectorAll("label"),s=r.length,o=0;o<s;o++)l=r[o].getAttribute("for"),r[o].setAttribute("for","popup-"+l),c=h.querySelector("#"+l),c&&c.setAttribute("id","popup-"+l);if(v)for(i=v.length,o=0;o<i;o++)a=h.querySelector(v[o].selector),a.addEventListener(v[o].event,v[o].handler,!1);e.controls.callback(),e.handlers.showPopup(u,p,h,function(){var n;f(h),t.length&&(n=t.splice(0,1),e.handlers.hide(),e.controls.callback=function(){e.show(n[0])})})},getPos:function(e){var t=e.getBoundingClientRect(),n=document.body,i=document.documentElement,o=i.clientTop||n.clientTop||0,a=i.clientLeft||n.clientLeft||0,r=t.top-o,s=t.left-a;return{top:Math.round(r),left:Math.round(s)}},hide:function(t){var n=e.controls,i=n.background,o=n.popup;e.handlers.hidePopup(i,o,n,function(){var e,i,o,a=n.handlers,r=n.popupContent;if(n.callback&&n.callback(t),a)for(e=a.length,o=0;o<e;o++)i=r.querySelector(a[o].selector),i.removeEventListener(a[o].event,a[o].handler,!1);n.hideCallback&&n.hideCallback(n.popupContent)})},buttonClick:function(t){e.handlers.hide(t.target)},buttonKeyUp:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var t=e.keyCode;switch(t){case 32:this.click();break;case 13:this.click()}},popupClick:function(t){var n,i=this,o=t.target,a=i.querySelectorAll(".popup__button, .popup-close"),r=a.length;for(t.stopPropagation(),n=0;n<r;n++)a[n]===o&&e.handlers.hide.call(e,t)},keydown:function(e){27===e.keyCode&&$(".popup-close").click()},backClick:function(e){$(".popup-close").click()}},this.create={template:function(){var t=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div"),o=e.controls,a=document.createElement("div");t.setAttribute("class","popup"),t.setAttribute("id","popup"),n.innerHTML='<div class="popup-close close-icon"></div>',n.setAttribute("class","popup__window"),n.setAttribute("id","popup__window"),i.setAttribute("class","popup__content"),i.appendChild(a),n.appendChild(i),t.appendChild(n),o.popupCloseButton=n.querySelector(".popup-close"),o.popupContent=i,o.popup=n,o.background=t},empty:function(e){var t=[];return t.push(e),t},htmlTemplate:function(e){var t=[],n=e.message.html();return t.push(n),t},confirm:function(e){var t=[],n=e.message;return n||(n=""),t.push('<div class="popup__message">'+n+"</div>"),t.push("</div>"),t}},this.destroy=function(){var t=e.controls;document.body.removeChild(t.background),t.inDom=!1},this.show=function(t,n){n?e.controls.callback=n:e.controls.callback=function(){return!1},e.handlers.show(t)},this.hide=function(){e.handlers.hide(null)},this.addEventList=function(){var t=e.handlers,n=e.controls;n.popup.addEventListener("click",t.popupClick,!1),document.body.addEventListener("keydown",t.keydown,!1),n.background.addEventListener("click",t.backClick,!1)},this.init=function(t,n){e.create.template()},this.getVisible=function(){return e.controls.isVisible},e.init()}var t=new e;return{show:function(e,n){t.show(e,n)},hide:function(e){t.controls.callback=e,t.hide()},isVisible:t.getVisible,self:function(){return t}}}();